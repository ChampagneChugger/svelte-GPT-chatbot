generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Page {
  id      Int    @id @default(autoincrement())
  slug    String @unique
  title   String
  content String
  userId  String
  user    user   @relation(fields: [userId], references: [id])
}

model Post {
  id         Int         @id @default(autoincrement())
  title      String
  coverImage String      @default("../thumbnail.jpg")
  content    String
  userId     String
  slug       String      @unique
  likes      BigInt      @default(0)
  views      BigInt      @default(0)
  user       user        @relation(fields: [userId], references: [id])
  PostLikes  PostLikes[]
}

model PostLikes {
  id     Int    @id @default(autoincrement())
  postId Int
  userId String
  Post   Post   @relation(fields: [postId], references: [id])
  user   user   @relation(fields: [userId], references: [id])
}

model key {
  id              String  @id @unique
  hashed_password String?
  user_id         String
  primary         Boolean
  user            user    @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id])
}

model session {
  id             String @id @unique
  user_id        String
  active_expires BigInt
  idle_expires   BigInt
  user           user   @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id])
}

model user {
  id              String      @id @unique
  name            String
  username        String      @unique
  role            Int         @default(0)
  profile_picture String      @default("/korisnik.svg")
  email           String      @unique
  about           String?
  videoid         String
  Page            Page[]
  Post            Post[]
  PostLikes       PostLikes[]
  key             key[]
  session         session[]
}
